spring.application.name=webapp

# when neither profile is set, then the "Default" profile is set which is basically the same as dev and is just the one we've been using this whole time
# spring.profiles.active=dev 
# spring.profiles.active=prod 

# Database Configuration (Development)
# H2 database configuration with console access
spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.username=sa
spring.datasource.password=
spring.datasource.driver-class-name=org.h2.Driver

# JPA/Hibernate Configuration
# Clean schema matching entities each restart (prevents schema drift)
spring.jpa.hibernate.ddl-auto=create-drop
# Set to true for Debugging visibility during development
spring.jpa.show-sql=false
# Ensures JPA creates schema before data.sql runs
spring.jpa.defer-datasource-initialization=true

# Flyway Configuration (dev profile uses Hibernate schema generation instead)
spring.flyway.enabled=false

# Open-in-View Pattern Configuration
# What it is: Spring Boot feature that keeps Hibernate sessions open during entire web request
# including view rendering (templates). By default it's enabled (true).
#
# What it does when enabled (default):
# - Extends JPA session from service layer through controller to template rendering
# - Allows lazy loading to work in Thymeleaf templates (e.g., ${event.category.name})
# - Database connections stay open longer during view rendering
# - Can trigger N+1 queries scattered throughout template rendering
#
# Why we disable it (set to false):
# - Forces proper data loading patterns in service/repository layer
# - Prevents accidental lazy loading performance issues in templates
# - Creates predictable transaction boundaries (sessions close after service layer)
# - Encourages use of DTOs or @EntityGraph for explicit data loading
#
# Result when disabled:
# - If templates try to access lazy-loaded relationships, you'll get:
#   LazyInitializationException: "could not initialize proxy - no Session"
# - This forces you to fix data loading upfront rather than hide performance problems
# - Better overall application performance and clearer data access patterns
spring.jpa.open-in-view=false

# Initialize schema for Spring Security tables
# Forces persistent_logins table creation from data.sql
spring.sql.init.mode=always

# this setting confirms H2 is being used
# H2 Console Web App (development only, set to 'false' before prod)
# H2_CONSOLE_ENABLED is an environment variable (and overides true if found)
# set H2_CONSOLE_ENABLED=false as an environment variable
# Created: Set in operating system environment or deployment configuration
#
# H2 Console Access Information:
# URL: http://localhost:8080/h2-console
# JDBC URL: jdbc:h2:mem:testdb
# Username: sa
# Password: (empty)
# The console is enabled by default unless H2_CONSOLE_ENABLED environment variable is set to false
spring.h2.console.enabled=${H2_CONSOLE_ENABLED:true}
spring.h2.console.settings.web-allow-others=true

# Remember Me Security Key (development key, change for production)
app.remember-me.key=${REMEMBER_ME_KEY:A8Kj9P2mN5qR7sT1vX3wZ6cF4hL8nQ9eU2iO5pY7rE3wQ6tY9uI1oP4sA7dF2gH5k}

# Session Management Configuration
# Session timeout in seconds (1800 = 30 minutes)
server.servlet.session.timeout=1800

# Server Configuration
server.port=8080

# MySQL Database Configuration (Production - uncomment when switching from H2)
# spring.datasource.url=jdbc:mysql://localhost:3306/myapp
# spring.datasource.username=root
# spring.datasource.password=secret
# spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
# spring.jpa.hibernate.ddl-auto=update
# spring.jpa.defer-datasource-initialization=true
# spring.sql.init.mode=always

# Stripe API keys - use environment variables for security
# Set these via environment variables or in application-local.properties (add to .gitignore)
# Get your keys from: https://dashboard.stripe.com/test/apikeys
stripe.api.key=${STRIPE_API_KEY:}
stripe.publishable.key=${STRIPE_PUBLISHABLE_KEY:}
# Stripe webhook secret for local dev
# Get from: stripe listen --forward-to localhost:8080/api/payments/webhook
# Production webhook secret is configured in application-prod.properties
stripe.webhook.secret=${STRIPE_WEBHOOK_SECRET:}

# Photo Gallery Configuration
# Upload directory for event photos (local filesystem storage)
# Use absolute path or ${user.dir} to avoid Tomcat temp directory issues
photo.upload.dir=${user.dir}/uploads